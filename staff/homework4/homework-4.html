<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.9.1: http://docutils.sourceforge.net/" />
<title>Homework #4</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7434 2012-05-11 21:06:27Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { /* line numbers */
  color: grey;
}

.code {
  background-color: #eeeeee
}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="homework-4">
<h1 class="title">Homework #4</h1>

<div class="section" id="introduction">
<h1>1. Introduction</h1>
<p>In this homework, you will implement a rating system for the questions offered by your quiz app.
Users will be able to see
the ratings of every question as well as rate questions. For each question, a user can tell
whether he or she likes the question, dislikes it, or thinks that the question is incorrect.
The app should display the number of likes, dislikes, and incorrect questions. This
allows users to quickly assess the quality of the questions.</p>
<p>Please keep track of how many hours it takes you to solve each exercise, as we
will ask you to provide us with this information in a text file named <tt class="docutils literal">homework_4_time_spent.txt</tt> that
resides in the <tt class="docutils literal">${REPO}</tt> folder (defined below).</p>
<p>Please abide by the <a class="reference external" href="http://sweng.epfl.ch/collaboration">Collaboration Policy</a>. If you have any questions
regarding the assignment requirements, ask on <a class="reference external" href="https://piazza.com/epfl.ch/fall2012/cs305/home">Piazza</a>. If you have any doubts
about whether it is appropriate to ask something, mark the question private. You
are allowed to use Web search to find answers to questions.</p>
<div class="section" id="preparation">
<h2>Preparation</h2>
<p>As for all previous and future homework assignments, you should regularly commit your work, push it to your
repository, and build it on the <a class="reference external" href="http://jenkins.epfl.ch/">Jenkins</a> server.</p>
<p><a class="reference external" href="http://jenkins.epfl.ch/">Jenkins</a> will send a notification to you by e-mail if the source code that you
committed does not compile or is improperly formatted.  The system will
automatically give 0 points to submissions that do not compile or
violate the <a class="reference external" href="http://sweng.epfl.ch/tutorials/checkstyle">SwEng coding style</a>. We strongly recommend that you commit
regularly before the deadline to make sure everything works as expected.</p>
<p>The deadline for this homework is  <strong>Friday, November 16, 2012</strong>, at <strong>19:00</strong>. Any assignments (or
parts thereof) handed in late will not be graded.</p>
</div>
<div class="section" id="basic-track-vs-full-track">
<h2>Basic Track vs. Full track</h2>
<p>This homework has two parts:</p>
<ul class="simple">
<li>The basic track implements the rating functionality, and</li>
<li>The full track additionally adds tests to ensure the reliability of the features implemented in the basic track.</li>
</ul>
<p>The total number of points for this homework is 100. Completely and correctly solving the basic track will earn you 70 points,
while completely and correctly solving the full track will earn you 30 additional points, for a maximum of 100.</p>
</div>
</div>
<div class="section" id="basic-track-implementing-the-rating-system-70-points">
<h1>2. [Basic track] Implementing the Rating System (70 points)</h1>
<div class="section" id="extending-the-user-interface-for-ratings-20-points">
<h2>2.1 Extending the User Interface for Ratings (20 points)</h2>
<p>In this part, you will extend the user interface to enable users to rate questions, see how a question is rated,
and verify their own rating.</p>
<p>Add three buttons to the <tt class="docutils literal">ShowQuestionActivity</tt> activity: one to &quot;like&quot; the currently shown question,
one to &quot;dislike&quot; it, and one to flag it as &quot;incorrect&quot;.</p>
<div class="admonition-grading admonition">
<p class="first admonition-title">Grading</p>
<p>The buttons can be displayed in any form and their text can be anything,
but their label must be exactly the words 'Like', 'Dislike', or 'Incorrect', corresponding to their function.
The button label must also include the current number of votes as an integer in parenthesis, separated from the rating by one space.
For example, the following button labels are acceptable: &quot;Like (1)&quot;, &quot;Dislike (0)&quot;, &quot;Incorrect (123)&quot;.</p>
<p class="last">In this exercise, you may display an arbitrary number of votes on each button. In the next exercise,
you will implement the server communication protocol to display the real number.</p>
</div>
<p>Finally, add a <tt class="docutils literal">TextView</tt> to display the user's current rating.</p>
<div class="admonition-grading admonition">
<p class="first admonition-title">Grading</p>
<p>The <tt class="docutils literal">TextView</tt> must contain  &quot;You like the question&quot;, &quot;You dislike the question&quot;,
&quot;You think the question is incorrect&quot;, or &quot;You have not rated this question&quot;, depending
on whether the user likes or dislikes the question, finds it incorrect, or has not rated it yet, respectively.</p>
<p class="last">In this exercise, you may display an arbitrary rating in the <tt class="docutils literal">TextView</tt>. In the next exercise,
you will implement the server communication protocol to display the real rating.</p>
</div>
</div>
<div class="section" id="implementing-the-server-communication-50-points">
<h2>2.2. Implementing the Server Communication (50 points)</h2>
<p>Now that the interface is laid out, you implement the server protocol.
This section describes the server protocol used to set and to retrieve ratings.</p>
<p>At the end of this section, you will find how to integrate the implementation of the
protocol with the GUI that you implemented in the previous exercise.</p>
<p><strong>Retrieve all ratings</strong></p>
<p><em>Request:</em></p>
<p>The following query returns the aggregated count of each type of rating for the given question.</p>
<pre class="code literal-block">
GET /quizquestions/&lt;question_id&gt;/ratings
</pre>
<p><em>Reply:</em></p>
<p>The server always returns <tt class="docutils literal">200 OK</tt> with the following body, indicating how many people
liked the question, how many disliked it, and how many rated it as incorrect:</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">{
    <span style="color: #BA2121">&quot;likeCount&quot;</span><span style="color: #666666">:</span> <span style="color: #666666">12</span>,
    <span style="color: #BA2121">&quot;dislikeCount&quot;</span><span style="color: #666666">:</span> <span style="color: #666666">0</span>,
    <span style="color: #BA2121">&quot;incorrectCount&quot;</span><span style="color: #666666">:</span> <span style="color: #666666">0</span>
}
</pre></div>
<p>All counts are positive integers. If nobody rated the question, then all counts are zero.</p>
<p><strong>Retrieve the personal rating</strong></p>
<p><em>Request:</em></p>
<p>The following query returns the user's own rating for the requested question:</p>
<pre class="code literal-block">
GET /quizquestions/&lt;question_id&gt;/rating
</pre>
<p><em>Reply:</em></p>
<ul>
<li><p class="first">The server returns with status <tt class="docutils literal">200 OK</tt> in case of success. The body of the reply contains the rating,
which can be either <tt class="docutils literal">like</tt>, <tt class="docutils literal">dislike</tt>, or <tt class="docutils literal">incorrect</tt>, depending on the user's rating.</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">{
   <span style="color: #BA2121">&quot;verdict&quot;</span><span style="color: #666666">:</span> <span style="color: #BA2121">&quot;like&quot;</span>
}
</pre></div>
</li>
<li><p class="first">The server returns with status <tt class="docutils literal">204 No Content</tt> if the user did not rate the question (the status code indicates that the body of the response is empty).</p>
</li>
<li><p class="first">The server returns with status <tt class="docutils literal">404 Not Found</tt> or <tt class="docutils literal">401 Unauthorized</tt>, if the question does not exist or the user is not authenticated. The body
explains the error in more detail:</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">{
   <span style="color: #BA2121">&quot;message&quot;</span><span style="color: #666666">:</span> <span style="color: #BA2121">&quot;error message&quot;</span>
}
</pre></div>
</li>
</ul>
<p><strong>Post a rating</strong></p>
<p><em>Request:</em></p>
<p>Users can rate a question or update their rating by sending the following request:</p>
<pre class="code literal-block">
POST /quizquestions/&lt;question_id&gt;/rating
</pre>
<p>The body of the request contains the field <tt class="docutils literal">verdict</tt>, which can be either
<tt class="docutils literal">like</tt>, <tt class="docutils literal">dislike</tt> or <tt class="docutils literal">incorrect</tt>, corresponding to the user's rating.</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">{
   <span style="color: #BA2121">&quot;verdict&quot;</span><span style="color: #666666">:</span> <span style="color: #BA2121">&quot;like&quot;</span>
}
</pre></div>
<p><em>Reply:</em></p>
<ul>
<li><p class="first">The server returns status code <tt class="docutils literal">201 Created</tt> (or <tt class="docutils literal">200 OK</tt> if a rating already existed and
has been updated).</p>
</li>
<li><p class="first">The server returns status code <tt class="docutils literal">404 Not Found</tt> or <tt class="docutils literal">401 Unauthorized</tt>, if the question does not exist or the user is not authenticated. The body
of the response contains an error message describing the problem in more
detail:</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">{
   <span style="color: #BA2121">&quot;message&quot;</span><span style="color: #666666">:</span> <span style="color: #BA2121">&quot;error message&quot;</span>
}
</pre></div>
</li>
</ul>
<div class="admonition-grading admonition">
<p class="first admonition-title">Grading</p>
<p class="last">You must use the same mechanisms to communicate with the server as defined in Homework 1. Failing to do so will prevent automated testing.</p>
</div>
<p>If anything goes wrong, e.g., the server responds with a non-200 status code, returns unexpected data, or executing the request generates an <tt class="docutils literal">Exception</tt>,
you must display &quot;There was an error retrieving the ratings&quot; or &quot;There was an error setting the rating&quot; as appropriate (e.g., in a <a class="reference external" href="http://developer.android.com/guide/topics/ui/notifiers/toasts.html">toast</a> message ).</p>
<p>After you implement the server protocol, modify the <tt class="docutils literal">ShowQuestionActivity</tt> class as follows:</p>
<ul>
<li><p class="first">After the activity is loaded and the question is shown, the activity must perform the following:</p>
<blockquote>
<ol class="arabic simple">
<li>Query the server for the current ratings</li>
<li>Display the current ratings on the buttons</li>
<li>Display the user's personal rating</li>
</ol>
</blockquote>
</li>
<li><p class="first">When a user clicks on a button to rate a question, the activity must perform the following:</p>
<blockquote>
<ol class="arabic simple">
<li>Send to the server a query to set the user's rating for that question</li>
<li>Parse the reply</li>
<li>Update the <tt class="docutils literal">TextView</tt> that displays the user's personal rating</li>
<li>Query the server for the current ratings of that question</li>
<li>Display the updated ratings on the buttons for that question</li>
</ol>
</blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="full-track-code-coverage-30-points">
<h1>3. [Full Track] Code Coverage (30 points)</h1>
<p>Now that you have implemented the basic track for this homework,
it is time to verify that your code performs as expected. Check
this by writing unit tests for your application. The goal for the
tests you write is to achieve <strong>80%</strong> code coverage for the code
you wrote so far for <strong>Homework #1, Homework #2, Homework #3, Exam #1, and Exam #2</strong>.</p>
<p>Only the code coverage generated by the tests that pass counts toward the 80% code coverage goal.
So, if you achieve 80% coverage, yet none of your tests pass, you will receive 0 points for this part of the homework.</p>
<p>Your tests should take less than 20 minutes to finish running. After the 20 minutes run out, Jenkins will stop running your tests.</p>
<div class="admonition-grading admonition">
<p class="first admonition-title">Grading</p>
<p>Your tests may only use the default testing features provided by the Android SDK or <a class="reference external" href="http://code.google.com/p/robotium/downloads/detail?name=robotium-solo-3.4.1.jar">Robotium 3.4.1</a>.
Using any other testing tools, libraries, or versions of Robotium will make it impossible for us to automatically run your tests and compute their code coverage, so you will lose points.</p>
<blockquote class="last">
<p>The number of points will be computed using the same rules as in Homework #1, i.e.,
with the following formula:</p>
<blockquote>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">30 * min<span style="color: #666666">(</span>1, <span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">${</span><span style="color: #19177C">CODE_COVERAGE</span><span style="color: #008000; font-weight: bold">}</span>/80<span style="color: #666666">)</span>^2<span style="color: #666666">)</span>
</pre></div>
</blockquote>
<p>In other words, your tests must achieve 80% line coverage for the entire code
base of your application in order for you to get the full points for this part of the homework.</p>
</blockquote>
</div>
</div>
<div class="section" id="final-checklist">
<h1>4. Final Checklist</h1>
<p>Grading for this homework will be completely automated. This means that your
homework's project structure, code, package names, button labels, <tt class="docutils literal">Activity</tt>
names, etc., must conform to the rules below. Otherwise, our servers will not be able to
automatically grade your homework, and you will lose points.</p>
<p>Here is a recap of the rules your homework must obey:</p>
<ul>
<li><p class="first">Rules set in the previous homeworks regarding the project structure still apply</p>
</li>
<li><p class="first">Your <tt class="docutils literal">${REPO}</tt> must have the following folder structure:</p>
<pre class="literal-block">
${REPO}
├── Sweng2012QuizApp
|&nbsp;&nbsp; ├── assets
|&nbsp;&nbsp; ├── libs
|&nbsp;&nbsp; ├── res
|&nbsp;&nbsp; └── src
| &nbsp;     └── epfl
|&nbsp;&nbsp;         └── sweng
|               ├── editquestions
|               |   └── EditQuestionActivity.java
|               ├── entry
|               |   └── MainActivity.java
|               ├── quizquestions
|               |   └── QuizQuestion.java
|               ├── showquestions
|               |   └── ShowQuestionsActivity.java
|               └── authentication
|                   └── AuthenticationActivity.java
└── Sweng2012QuizAppTest
 &nbsp;&nbsp; ├── assets
 &nbsp;&nbsp; ├── libs
 &nbsp;&nbsp; ├── res
 &nbsp;&nbsp; └── src
 &nbsp;&nbsp;     └── epfl
 &nbsp;&nbsp;         └── sweng
                └── test
</pre>
</li>
<li><p class="first">You can have additional classes in the <tt class="docutils literal">epfl.sweng</tt> package</p>
</li>
<li><p class="first">The following command must fully compile and install your app in an emulator:</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #19177C">$ </span><span style="color: #008000">cd</span> <span style="color: #008000; font-weight: bold">${</span><span style="color: #19177C">REPO</span><span style="color: #008000; font-weight: bold">}</span>/Sweng2012QuizApp
<span style="color: #19177C">$ </span>ant clean debug install
</pre></div>
</li>
<li><p class="first">The following command must run your installed app on an emulator:</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #19177C">$ </span>adb shell am start -a android.intent.action.MAIN -n epfl.sweng/.entry.MainActivity
</pre></div>
</li>
<li><p class="first">The following command must compile and run all your tests:</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #19177C">$ </span><span style="color: #008000">cd</span> <span style="color: #008000; font-weight: bold">${</span><span style="color: #19177C">REPO</span><span style="color: #008000; font-weight: bold">}</span>/Sweng2012QuizAppTest
<span style="color: #19177C">$ </span>ant clean emma debug install <span style="color: #008000">test</span>
</pre></div>
</li>
<li><p class="first">The rules defined in Homework #1 for accessing the network still apply</p>
</li>
<li><p class="first">Your code must be committed to the <tt class="docutils literal"><span class="pre">https://github.com/dslab-epfl/&lt;reponame&gt;.git</span></tt>
git repository, where <tt class="docutils literal">&lt;reponame&gt;</tt> is the name of your team's repository</p>
</li>
</ul>
</div>
</div>
</body>
</html>
